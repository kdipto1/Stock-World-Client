{"version":3,"file":"MyProducts-BiaJQr4o.js","sources":["../../src/Pages/MyProducts/MyProducts.tsx"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport axios from \"axios\";\nimport { signOut } from \"firebase/auth\";\nimport toast from \"react-hot-toast\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport auth from \"../../firebase.init\";\nimport LoadingSpinner from \"../../components/LoadingSpinner\";\nimport { IInventoryItem } from \"../../types\";\n\nconst MyProducts = () => {\n  const navigate = useNavigate();\n  const queryClient = useQueryClient();\n  const accessToken = localStorage.getItem(\"accessToken\");\n  const email = localStorage.getItem(\"email\");\n\n  const { data: myItems, isLoading } = useQuery<IInventoryItem[]>({\n    queryKey: [\"myItems\"],\n    queryFn: async () => {\n      const res = await fetch(\n        `https://stock-world-server.onrender.com/inventoryUser?email=${email}`,\n        {\n          headers: {\n            Authorization: `${email} ${accessToken}`,\n          },\n        }\n      );\n      if (res.status === 403 || res.status === 401) {\n        signOut(auth);\n        navigate(\"/login\");\n        toast.error(\"Unauthorized access. Please log in again.\");\n        throw new Error(\"Unauthorized\");\n      }\n      if (!res.ok) {\n        throw new Error(\"Failed to fetch user products\");\n      }\n      return res.json();\n    },\n    enabled: !!email && !!accessToken,\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) =>\n      axios.delete(`https://stock-world-server.onrender.com/inventory/${id}`, {\n        headers: {\n          Authorization: `${email} ${accessToken}`,\n        },\n      }),\n    onSuccess: () => {\n      toast.success(\"Item deleted successfully!\");\n      queryClient.invalidateQueries({ queryKey: [\"myItems\"] });\n    },\n    onError: (error: any) => {\n      toast.error(\n        error.response?.data?.message ||\n          error.message ||\n          \"Failed to delete item\"\n      );\n    },\n  });\n\n  const handleDelete = (id: string) => {\n    if (window.confirm(\"Are you sure you want to delete this item?\")) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  if (isLoading) {\n    return <LoadingSpinner message=\"Loading your products...\" />;\n  }\n\n  return (\n    <section className=\"min-h-screen bg-base-200 py-12\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <h1 className=\"text-4xl font-bold\">My Products</h1>\n          <Link to=\"/addProduct\" className=\"btn btn-primary\">\n            Add New Product\n          </Link>\n        </div>\n\n        <div className=\"card bg-base-100 shadow-lg\">\n          <div className=\"card-body\">\n            <div className=\"overflow-x-auto\">\n              <table className=\"table w-full\">\n                <thead>\n                  <tr>\n                    <th>Product</th>\n                    <th>Quantity</th>\n                    <th>Price</th>\n                    <th className=\"text-center\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {myItems?.map((product) => (\n                    <tr key={product._id} className=\"hover\">\n                      <td>\n                        <div className=\"flex items-center space-x-3\">\n                          <div className=\"avatar\">\n                            <div className=\"mask mask-squircle w-12 h-12\">\n                              <img\n                                src={product.image}\n                                alt={product.name}\n                              />\n                            </div>\n                          </div>\n                          <div>\n                            <div className=\"font-bold\">{product.name}</div>\n                            <div className=\"text-sm opacity-50\">\n                              {product.supplier}\n                            </div>\n                          </div>\n                        </div>\n                      </td>\n                      <td>{product.quantity}</td>\n                      <td>${product.price}</td>\n                      <th className=\"text-center\">\n                        <Link\n                          to={`/manageProduct/${product._id}`}\n                          className=\"btn btn-ghost btn-xs\"\n                        >\n                          details\n                        </Link>\n                        <button\n                          className=\"btn btn-ghost btn-xs\"\n                          onClick={() => handleDelete(product._id)}\n                          disabled={deleteMutation.isPending}\n                        >\n                          delete\n                        </button>\n                      </th>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport default MyProducts;"],"names":["MyProducts","navigate","useNavigate","queryClient","useQueryClient","accessToken","email","myItems","isLoading","useQuery","res","signOut","auth","toast","deleteMutation","useMutation","id","axios","error","_b","_a","handleDelete","jsx","LoadingSpinner","jsxs","Link","product"],"mappings":"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"}