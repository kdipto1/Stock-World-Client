import{f as u,a as j,b as y,s as g,e as b,V as i,j as e,L as v,c as o}from"./index-CH7ozQmp.js";import{u as N}from"./useMutation-cqouCRVi.js";import{a as f}from"./index-C0Bg54wM.js";import"./vendor-CM02gYGk.js";const $=()=>{const d=u(),m=j(),a=localStorage.getItem("accessToken"),t=localStorage.getItem("email"),{data:n,isLoading:h}=y({queryKey:["myItems"],queryFn:async()=>{const s=await fetch(`https://stock-world-server.onrender.com/inventoryUser?email=${t}`,{headers:{Authorization:`${t} ${a}`}});if(s.status===403||s.status===401)throw g(b),d("/login"),i.error("Unauthorized access. Please log in again."),new Error("Unauthorized");if(!s.ok)throw new Error("Failed to fetch user products");return s.json()},enabled:!!t&&!!a}),r=N({mutationFn:s=>f.delete(`https://stock-world-server.onrender.com/inventory/${s}`,{headers:{Authorization:`${t} ${a}`}}),onSuccess:()=>{i.success("Item deleted successfully!"),m.invalidateQueries({queryKey:["myItems"]})},onError:s=>{var c,l;i.error(((l=(c=s.response)==null?void 0:c.data)==null?void 0:l.message)||s.message||"Failed to delete item")}}),x=s=>{window.confirm("Are you sure you want to delete this item?")&&r.mutate(s)};return h?e.jsx(v,{message:"Loading your products..."}):e.jsx("section",{className:"min-h-screen bg-base-200 py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"My Products"}),e.jsx(o,{to:"/addProduct",className:"btn btn-primary",children:"Add New Product"})]}),e.jsx("div",{className:"card bg-base-100 shadow-lg",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Price"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:n==null?void 0:n.map(s=>e.jsxs("tr",{className:"hover",children:[e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"mask mask-squircle w-12 h-12",children:e.jsx("img",{src:s.image,alt:s.name})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold",children:s.name}),e.jsx("div",{className:"text-sm opacity-50",children:s.supplier})]})]})}),e.jsx("td",{children:s.quantity}),e.jsxs("td",{children:["$",s.price]}),e.jsxs("th",{className:"text-center",children:[e.jsx(o,{to:`/manageProduct/${s._id}`,className:"btn btn-ghost btn-xs",children:"details"}),e.jsx("button",{className:"btn btn-ghost btn-xs",onClick:()=>x(s._id),disabled:r.isPending,children:"delete"})]})]},s._id))})]})})})})]})})};export{$ as default};
//# sourceMappingURL=MyProducts-BiaJQr4o.js.map
